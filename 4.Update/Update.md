# Сложный update

[Задание 1](#Задание1)

### Update + From:

_UPDATE_ в сочетании с _FROM_ используется для обновления значений столбцов в одной таблице на основе значений из
другой таблицы. Например:

```sql
UPDATE table1
SET table1.column = table2.column
FROM table1
WHERE table1.column1 = table2.column2;
```

### Update + CONFLICT или _upsert_:

Для операции `upsert` в _PostgreSQL_ рекомендуется использовать команды `INSERT` в сочетании с `ON CONFLICT`. Вот
основной
образец SQL для `upsert`:

```sql

INSERT INTO целевая_таблица (список_столбцов)
SELECT данные_для_вставки
FROM исходные_данные
ON CONFLICT (столбцы_конфликта) DO UPDATE
    SET обновляемый_столбец = EXCLUDED.обновляемый_столбец;
```

С помощью `EXCLUDED` описывается строка, которая могла быть добавлена в отсутствие конфликта.

`ON CONFLICT` применяется для столбцов только имюещих ограниченния по типу `uniqe`, `constraint`

### Задание1

1. В [1.sql](1.sql) пропишите изменение всех пустых полей _menu.pizzeria_name_ на имена пиццерий в соответсвии с
   _pizzeria_id_
2. Представьте, что вы ошиблись когда забивали самый ваш первый заказ в таблицу, и не знаете добавился ли он. Попробуйте
   добавить его заново, но уже через upsert.
   > _Т.е если так окажется что поле с заказом, айди которого __равен 1__ уже есть, его нужно __просто изменить___

   Про заказ
    - Айди заказа должно быть один
    - Заказ должен быть на имя Анна
    - Заказывали '_cheese pizza_' с ценой 900 не важно из какой пиццерии
    - Дата заказа _10 января 2022_

   
      Все данны за исключением айди, нужно получить за счет вложенных запрсов
   